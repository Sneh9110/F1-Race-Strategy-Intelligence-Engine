# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and update with your actual values
# DO NOT commit .env to version control!

# Environment (development, staging, production)
ENVIRONMENT=development

# =============================================================================
# DATABASE CONFIGURATION (PostgreSQL with TimescaleDB)
# =============================================================================
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=f1_strategy
DATABASE_USER=f1_user
DATABASE_PASSWORD=your_secure_password_here

# Connection pool settings
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=  # Leave empty if no password
REDIS_MAX_CONNECTIONS=50

# Cache TTL settings (seconds)
CACHE_TTL_PREDICTIONS=60
CACHE_TTL_FEATURES=300
CACHE_TTL_WEATHER=180
CACHE_TTL_TELEMETRY=5

# =============================================================================
# API CONFIGURATION
# =============================================================================
API_HOST=0.0.0.0
API_PORT=8000
API_RELOAD=true  # Auto-reload on code changes (development only)
API_WORKERS=4
API_LOG_LEVEL=info
API_CORS_ORIGINS=["http://localhost:3000", "http://localhost:8000"]

# API Rate Limiting
API_RATE_LIMIT_PER_MINUTE=60
API_RATE_LIMIT_BURST=10

# API Authentication (JWT)
JWT_SECRET_KEY=your_super_secret_jwt_key_change_me_in_production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# =============================================================================
# MACHINE LEARNING MODEL CONFIGURATION
# =============================================================================
MODEL_REGISTRY_PATH=./models/registry
MODEL_CACHE_PATH=./models/cache

# Model retraining schedule
MODEL_RETRAIN_INTERVAL_HOURS=24
MODEL_MIN_SAMPLES=1000
MODEL_VALIDATION_SPLIT=0.2

# Model-specific settings
TIRE_DEGRADATION_MODEL_LOOKBACK_LAPS=10
LAP_TIME_MODEL_FEATURES=["tire_age", "fuel_load", "track_temp", "tire_compound"]
SAFETY_CAR_MODEL_CONFIDENCE_THRESHOLD=0.7
PIT_STOP_LOSS_MODEL_TRACK_SPECIFIC=true

# =============================================================================
# DATA PIPELINE CONFIGURATION
# =============================================================================
DATA_INGEST_INTERVAL_SECONDS=5
DATA_BATCH_SIZE=100
DATA_MAX_RETRY_ATTEMPTS=3
DATA_RETRY_BACKOFF_SECONDS=10

# Data validation
DATA_ENABLE_OUTLIER_DETECTION=true
DATA_OUTLIER_Z_SCORE_THRESHOLD=3.0
DATA_MIN_SECTOR_TIME_SECONDS=5.0
DATA_MAX_SECTOR_TIME_SECONDS=60.0

# Data storage paths
DATA_RAW_PATH=./data/raw
DATA_PROCESSED_PATH=./data/processed
DATA_FEATURES_PATH=./data/features
DATA_BACKUP_PATH=./data/backup

# =============================================================================
# EXTERNAL DATA SOURCES
# =============================================================================
# FIA Timing API (if available)
FIA_TIMING_API_URL=
FIA_TIMING_API_KEY=

# Weather API
WEATHER_API_URL=https://api.openweathermap.org/data/2.5
WEATHER_API_KEY=your_openweather_api_key

# Ergast F1 API (historical data)
ERGAST_API_URL=https://ergast.com/api/f1
ERGAST_API_RATE_LIMIT_PER_SECOND=4

# FastF1 telemetry cache
FASTF1_CACHE_PATH=./data/fastf1_cache

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json or text
LOG_FILE_PATH=./logs/app.log
LOG_ROTATION_SIZE_MB=100
LOG_BACKUP_COUNT=10
LOG_ENABLE_CONSOLE=true
LOG_ENABLE_FILE=true

# Structured logging fields
LOG_INCLUDE_TIMESTAMP=true
LOG_INCLUDE_HOSTNAME=true
LOG_INCLUDE_PROCESS_ID=true

# =============================================================================
# MONITORING AND OBSERVABILITY
# =============================================================================
# Sentry (Error Tracking)
SENTRY_DSN=  # Add your Sentry DSN here
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1  # 10% of transactions
SENTRY_PROFILES_SAMPLE_RATE=0.1

# Prometheus (Metrics)
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
PROMETHEUS_METRICS_PATH=/metrics

# Health check
HEALTH_CHECK_INTERVAL_SECONDS=30

# =============================================================================
# SIMULATION ENGINE CONFIGURATION
# =============================================================================
SIMULATION_NUM_ITERATIONS=10000
SIMULATION_TIME_LIMIT_SECONDS=60
SIMULATION_PARALLEL_WORKERS=4
SIMULATION_ENABLE_GPU=false

# Monte Carlo parameters
MONTE_CARLO_CONFIDENCE_LEVEL=0.95
MONTE_CARLO_VARIANCE_TIRE_DEG=0.02
MONTE_CARLO_VARIANCE_PIT_STOP=0.5
MONTE_CARLO_VARIANCE_SAFETY_CAR=0.15

# =============================================================================
# DECISION ENGINE CONFIGURATION
# =============================================================================
DECISION_UPDATE_INTERVAL_SECONDS=10
DECISION_ENABLE_RISK_ANALYSIS=true
DECISION_ENABLE_OVERTAKE_PROBABILITY=true
DECISION_ENABLE_TRAFFIC_ANALYSIS=true

# Strategy optimization
STRATEGY_OPTIMIZATION_TIME_LIMIT_SECONDS=30
STRATEGY_MAX_ALTERNATIVES=5
STRATEGY_MIN_CONFIDENCE_SCORE=0.6

# =============================================================================
# FEATURE FLAGS
# =============================================================================
ENABLE_TELEMETRY_INGESTION=true
ENABLE_WEATHER_FORECASTING=true
ENABLE_REAL_TIME_PREDICTIONS=true
ENABLE_STRATEGY_SUGGESTIONS=true
ENABLE_MOCK_DATA=false  # Use mock data instead of real API calls (development)

# =============================================================================
# PERFORMANCE AND SCALING
# =============================================================================
# Worker processes
NUM_API_WORKERS=4
NUM_INGESTION_WORKERS=2
NUM_PREDICTION_WORKERS=2
NUM_SIMULATION_WORKERS=1

# Memory limits (MB)
MAX_MEMORY_PER_WORKER=2048
MAX_CACHE_SIZE_MB=1024

# Request limits
MAX_REQUEST_SIZE_MB=10
REQUEST_TIMEOUT_SECONDS=30

# =============================================================================
# SECURITY
# =============================================================================
# SSL/TLS
ENABLE_HTTPS=false
SSL_CERT_PATH=
SSL_KEY_PATH=

# CORS
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["GET", "POST", "PUT", "DELETE"]
CORS_ALLOW_HEADERS=["*"]

# API Keys (for external clients)
API_KEY_HEADER=X-API-Key
VALID_API_KEYS=[]  # Add API keys as comma-separated list

# =============================================================================
# TESTING
# =============================================================================
TEST_DATABASE_URL=postgresql://f1_user:password@localhost/f1_strategy_test
TEST_REDIS_DB=1
TEST_ENABLE_COVERAGE=true
TEST_PARALLEL_WORKERS=4

# =============================================================================
# DEBUGGING
# =============================================================================
DEBUG_MODE=false
DEBUG_SQL_QUERIES=false
DEBUG_CACHE_HITS=false
DEBUG_TIMING_BREAKDOWN=false
DEBUG_SAVE_PREDICTIONS=true
